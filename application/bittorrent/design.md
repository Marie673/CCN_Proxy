# BitTorrentモジュール

## 概要

BitTorrentプロトコルに準拠した処理を行うモジュール。

## 機能要件

* Torrentファイルの解析
  * メタデータを抽出し、info_hashを計算する
* ピアとの通信
  * ファイルのダウンロードとアップロードを行える。
  * 指定したピースを取得できる。
  * 帯域を最大限利用できるリクエスト送信ができる。
* トラッカーとの通信
* エラーハンドリング
* 非同期にピースを取得できる

### 考慮すべき点

* Proxyとして、必要なピースのみをダウンロードするモードと、BitTorrentクライアントとしてピースを効率よく取得するモードが必要。
* 同じピアに同時に複数のリクエストを送信する可能性がある。
* 接続しているピアから無作為にメッセージが届く可能性がある。
* ピースを欲しいピアがこのモジュールに対して接続を確立できる。

## Peerモジュール

### 概要

ピアとの通信を担当するモジュール。

### 機能要件

* ピアの探索
  * トラッカーから提供されるピアリストを使用して利用可能なピアを探索する。
* ハンドシェイク
  * 接続を確立するためにピアとハンドシェイクを行う。
* メッセージの送受信
  * ピアとの間でメッセージを送受信する。
  * BitTorrentのメッセージ全てに対応している。

## Pieceモジュール

### 概要

ピースの管理を担当するモジュール。

### 機能要件

* ピースの管理
  * どのピースがダウンロードされ、どのピースがまだ必要なのかを追跡する。
  * どのピースが他のピアに提供可能かも追跡する。
  * 取得したピースのハッシュを確認し、トレントファイルのメタデータと一致することを確認する。

## Downloadモジュール

### 概要

ピースのダウンロードを担当するモジュール。

### 機能要件

* ピースのダウンロード
  * PeerモジュールとPieceモジュールを利用し、ピースをダウンロードする。

## Uploadモジュール

### 概要

ピースのアップロードを担当するモジュール。

### 機能要件

* ピースのアップロード
  * Peerからリクエストがあった場合、ピースを他のピアにアップロードできる。